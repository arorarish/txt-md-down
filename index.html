<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>TextDrop — Save Text Instantly</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    * {
      box-sizing: border-box;
    }

    :root {
      /* Light mode - Bold & Modern */
      --bg-primary: #fafafa;
      --bg-secondary: #ffffff;
      --bg-tertiary: #f4f4f5;
      --bg-card: #ffffff;
      --text-primary: #09090b;
      --text-secondary: #71717a;
      --text-tertiary: #a1a1aa;
      --border-color: #e4e4e7;
      --border-light: #f4f4f5;
      --accent-color: #3b82f6;
      --accent-hover: #2563eb;
      --accent-light: #dbeafe;
      --delete-color: #ef4444;
      --delete-hover: #dc2626;
      --success-color: #10b981;
      --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
      --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
      --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
    }

    body.dark-mode {
      --bg-primary: #09090b;
      --bg-secondary: #18181b;
      --bg-tertiary: #27272a;
      --bg-card: #18181b;
      --text-primary: #fafafa;
      --text-secondary: #a1a1aa;
      --text-tertiary: #71717a;
      --border-color: #27272a;
      --border-light: #3f3f46;
      --accent-color: #3b82f6;
      --accent-hover: #60a5fa;
      --accent-light: #1e3a8a;
      --delete-color: #ef4444;
      --delete-hover: #f87171;
      --success-color: #10b981;
      --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.3);
      --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.3), 0 2px 4px -2px rgb(0 0 0 / 0.3);
      --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.4), 0 4px 6px -4px rgb(0 0 0 / 0.4);
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      background-color: var(--bg-primary);
      color: var(--text-primary);
      display: flex;
      height: 100vh;
      margin: 0;
      transition: background-color 0.2s ease, color 0.2s ease;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    /* Sidebar */
    .sidebar {
      width: 340px;
      background: var(--bg-secondary);
      border-right: 1px solid var(--border-color);
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    .sidebar-header {
      padding: 24px 24px 16px;
      border-bottom: 1px solid var(--border-color);
    }

    .brand {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 16px;
    }

    .brand h2 {
      margin: 0;
      font-size: 20px;
      font-weight: 700;
      letter-spacing: -0.02em;
    }

    .theme-toggle {
      background: var(--bg-tertiary);
      border: none;
      border-radius: 8px;
      padding: 8px 10px;
      cursor: pointer;
      font-size: 18px;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .theme-toggle:hover {
      background: var(--border-light);
      transform: scale(1.05);
    }

    .search-box {
      position: relative;
    }

    .search-box input {
      width: 100%;
      padding: 10px 12px 10px 40px;
      border: 1px solid var(--border-color);
      border-radius: 8px;
      background: var(--bg-tertiary);
      color: var(--text-primary);
      font-size: 14px;
      font-family: inherit;
      transition: all 0.2s;
    }

    .search-box input:focus {
      outline: none;
      border-color: var(--accent-color);
      background: var(--bg-secondary);
      box-shadow: 0 0 0 3px var(--accent-light);
    }

    .search-icon {
      position: absolute;
      left: 14px;
      top: 50%;
      transform: translateY(-50%);
      width: 15px;
      height: 15px;
      opacity: 0.4;
      pointer-events: none;
      color: var(--text-secondary);
    }

    .sidebar-content {
      flex: 1;
      overflow-y: auto;
      padding: 16px;
    }

    .sidebar-footer {
      padding: 12px 16px;
      border-top: 1px solid var(--border-color);
    }

    .clear-all-btn {
      width: 100%;
      background: transparent;
      color: var(--delete-color);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      padding: 10px 16px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 600;
      font-family: inherit;
      transition: all 0.2s;
    }

    .clear-all-btn:hover {
      background: var(--delete-color);
      color: white;
      border-color: var(--delete-color);
    }

    /* File Cards */
    .card {
      background: var(--bg-card);
      border: 1px solid var(--border-color);
      border-radius: 12px;
      padding: 16px;
      margin-bottom: 12px;
      box-shadow: var(--shadow-sm);
      transition: all 0.2s;
    }

    .card:hover {
      box-shadow: var(--shadow-md);
      border-color: var(--border-light);
    }

    .card .title {
      font-weight: 600;
      font-size: 15px;
      margin-bottom: 6px;
      color: var(--text-primary);
    }

    .card .meta {
      font-size: 12px;
      color: var(--text-tertiary);
      margin-bottom: 8px;
    }

    .card .snippet {
      font-size: 13px;
      color: var(--text-secondary);
      margin-bottom: 12px;
      line-height: 1.5;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    .card-actions {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 8px;
    }

    .card-actions button {
      padding: 8px 12px;
      font-size: 13px;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      font-weight: 600;
      font-family: inherit;
      transition: all 0.2s;
    }

    .btn-view {
      background: var(--accent-color);
      color: white;
    }

    .btn-view:hover {
      background: var(--accent-hover);
      transform: translateY(-1px);
      box-shadow: var(--shadow-md);
    }

    .btn-edit {
      background: var(--bg-tertiary);
      color: var(--text-primary);
      border: 1px solid var(--border-color);
    }

    .btn-edit:hover {
      background: var(--border-light);
    }

    .btn-download {
      background: var(--bg-tertiary);
      color: var(--text-primary);
      border: 1px solid var(--border-color);
    }

    .btn-download:hover {
      background: var(--border-light);
    }

    .btn-delete {
      background: transparent;
      color: var(--delete-color);
      border: 1px solid var(--border-color);
    }

    .btn-delete:hover {
      background: var(--delete-color);
      color: white;
      border-color: var(--delete-color);
    }

    /* Main Content */
    .main {
      flex: 1;
      display: flex;
      align-items: flex-start;
      justify-content: center;
      padding: 48px 32px;
      overflow-y: auto;
    }

    .container {
      width: 100%;
      max-width: 640px;
    }

    .container h1 {
      margin: 0 0 8px 0;
      font-size: 36px;
      font-weight: 700;
      letter-spacing: -0.03em;
      background: linear-gradient(135deg, var(--text-primary) 0%, var(--text-secondary) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .subtitle {
      font-size: 16px;
      color: var(--text-secondary);
      margin-bottom: 40px;
    }

    .form-group {
      margin-bottom: 24px;
    }

    label {
      font-weight: 600;
      font-size: 14px;
      display: block;
      margin-bottom: 8px;
      color: var(--text-primary);
    }

    input[type="text"],
    textarea {
      width: 100%;
      font-family: inherit;
      padding: 12px 16px;
      border: 1px solid var(--border-color);
      border-radius: 12px;
      font-size: 15px;
      background: var(--bg-secondary);
      color: var(--text-primary);
      transition: all 0.2s;
    }

    input[type="text"]:focus,
    textarea:focus {
      outline: none;
      border-color: var(--accent-color);
      box-shadow: 0 0 0 3px var(--accent-light);
    }

    textarea {
      resize: vertical;
      min-height: 240px;
      line-height: 1.6;
      font-family: 'SF Mono', 'Monaco', 'Cascadia Code', monospace;
    }

    /* Toggle Switch */
    .toggle-wrapper {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .toggle-container {
      position: relative;
      width: 140px;
      height: 44px;
      background: var(--bg-tertiary);
      border-radius: 12px;
      padding: 4px;
      display: flex;
      align-items: center;
      border: 1px solid var(--border-color);
    }

    .toggle-slider {
      position: absolute;
      width: 66px;
      height: 36px;
      background: var(--accent-color);
      border-radius: 10px;
      transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: var(--shadow-md);
    }

    .toggle-slider.md {
      transform: translateX(68px);
    }

    .toggle-option {
      flex: 1;
      text-align: center;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      z-index: 1;
      transition: color 0.3s;
      padding: 10px;
    }

    .toggle-option.active {
      color: white;
    }

    .toggle-option.inactive {
      color: var(--text-tertiary);
    }

    /* Download Button */
    .download-btn {
      width: 100%;
      background: var(--accent-color);
      color: white;
      border: none;
      border-radius: 12px;
      padding: 16px 24px;
      font-size: 16px;
      font-weight: 700;
      cursor: pointer;
      font-family: inherit;
      transition: all 0.2s;
      box-shadow: var(--shadow-md);
    }

    .download-btn:hover {
      background: var(--accent-hover);
      transform: translateY(-2px);
      box-shadow: var(--shadow-lg);
    }

    .download-btn:active {
      transform: translateY(0);
    }

    /* Empty State */
    .empty-state {
      text-align: center;
      padding: 48px 24px;
      color: var(--text-tertiary);
    }

    .empty-state-icon {
      font-size: 48px;
      margin-bottom: 16px;
      opacity: 0.3;
    }

    .empty-state-text {
      font-size: 14px;
      line-height: 1.5;
    }

    /* Scrollbar */
    ::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }

    ::-webkit-scrollbar-track {
      background: transparent;
    }

    ::-webkit-scrollbar-thumb {
      background: var(--border-color);
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: var(--text-tertiary);
    }

    /* Responsive */
    @media (max-width: 768px) {
      .sidebar {
        width: 280px;
      }

      .main {
        padding: 24px 16px;
      }

      .container h1 {
        font-size: 28px;
      }
    }
  </style>
</head>
<body>
  <div class="sidebar">
    <div class="sidebar-header">
      <div class="brand">
        <h2>TextDrop</h2>
        <button class="theme-toggle" id="themeToggle" title="Toggle theme">🌙</button>
      </div>
      <div class="search-box">
        <svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="11" cy="11" r="8"></circle>
          <path d="m21 21-4.35-4.35"></path>
        </svg>
        <input type="text" id="searchInput" placeholder="Search files...">
      </div>
    </div>
    <div class="sidebar-content">
      <div id="fileList"></div>
    </div>
    <div class="sidebar-footer">
      <button class="clear-all-btn" id="clearAll">Clear All Files</button>
    </div>
  </div>

  <div class="main">
    <div class="container">
      <h1>Save text instantly</h1>
      <p class="subtitle">Paste your text and download it as a file in seconds</p>

      <div class="form-group">
        <label for="filename">File name</label>
        <input type="text" id="filename" placeholder="my-notes">
      </div>

      <div class="form-group">
        <label for="format">Format</label>
        <div class="toggle-wrapper">
          <div class="toggle-container" id="formatToggle">
            <div class="toggle-slider" id="toggleSlider"></div>
            <div class="toggle-option active" data-format="txt">.txt</div>
            <div class="toggle-option inactive" data-format="md">.md</div>
          </div>
        </div>
      </div>

      <div class="form-group">
        <label for="content">Content</label>
        <textarea id="content" placeholder="Paste your text here..."></textarea>
      </div>

      <button class="download-btn" id="download">Download File</button>
    </div>
  </div>

  <script>
    const storageKey = 'savedFiles';
    let currentFormat = 'txt';
    let allFiles = [];

    function getFiles() {
      return JSON.parse(localStorage.getItem(storageKey) || '[]');
    }

    function saveFileMeta(meta) {
      const files = getFiles();
      meta.id = Date.now() + '-' + Math.random().toString(36).substr(2, 9);
      files.push(meta);
      localStorage.setItem(storageKey, JSON.stringify(files));
    }

    function deleteFile(id) {
      const files = getFiles().filter(f => f.id !== id);
      localStorage.setItem(storageKey, JSON.stringify(files));
      loadAndRenderFiles();
    }

    function clearAllFiles() {
      if (confirm('Are you sure you want to delete all saved files? This cannot be undone.')) {
        localStorage.setItem(storageKey, JSON.stringify([]));
        loadAndRenderFiles();
      }
    }

    function redownloadFile(file) {
      const blob = new Blob([file.content], { type: 'text/plain' });
      const url = URL.createObjectURL(blob);
      const link = document.createElement('a');
      link.href = url;
      link.download = file.filename;
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      URL.revokeObjectURL(url);
    }

    function editFile(file) {
      document.getElementById('filename').value = file.filename.replace(/\.(txt|md)$/, '');
      document.getElementById('content').value = file.content;
      const ext = file.filename.match(/\.(txt|md)$/);
      if (ext) {
        setFormat(ext[1]);
      }
      document.getElementById('content').focus();
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function setFormat(format) {
      currentFormat = format;
      const slider = document.getElementById('toggleSlider');
      const options = document.querySelectorAll('.toggle-option');

      if (format === 'md') {
        slider.classList.add('md');
      } else {
        slider.classList.remove('md');
      }

      options.forEach(opt => {
        if (opt.dataset.format === format) {
          opt.classList.add('active');
          opt.classList.remove('inactive');
        } else {
          opt.classList.remove('active');
          opt.classList.add('inactive');
        }
      });
    }

    function loadAndRenderFiles() {
      allFiles = getFiles().sort((a, b) => b.timestamp - a.timestamp);
      const searchTerm = document.getElementById('searchInput').value.toLowerCase();
      renderList(searchTerm);
    }

    function renderList(searchTerm = '') {
      const listEl = document.getElementById('fileList');
      listEl.innerHTML = '';

      const filteredFiles = searchTerm
        ? allFiles.filter(f =>
            f.filename.toLowerCase().includes(searchTerm) ||
            f.snippet.toLowerCase().includes(searchTerm)
          )
        : allFiles;

      if (filteredFiles.length === 0) {
        const isEmpty = allFiles.length === 0;
        listEl.innerHTML = `
          <div class="empty-state">
            <div class="empty-state-icon">${isEmpty ? '📄' : '🔍'}</div>
            <div class="empty-state-text">
              ${isEmpty ? 'No files saved yet<br>Start by pasting some text!' : 'No files found<br>Try a different search'}
            </div>
          </div>
        `;
        return;
      }

      filteredFiles.forEach(file => {
        const card = document.createElement('div');
        card.className = 'card';

        const title = document.createElement('div');
        title.className = 'title';
        title.textContent = file.filename;

        const meta = document.createElement('div');
        meta.className = 'meta';
        meta.textContent = new Date(file.timestamp).toLocaleString();

        const snippet = document.createElement('div');
        snippet.className = 'snippet';
        snippet.textContent = file.snippet;

        const actions = document.createElement('div');
        actions.className = 'card-actions';

        const viewBtn = document.createElement('button');
        viewBtn.className = 'btn-view';
        viewBtn.textContent = 'View';
        viewBtn.addEventListener('click', () => {
          const blob = new Blob([file.content], { type: 'text/plain' });
          const url = URL.createObjectURL(blob);
          window.open(url, '_blank');
          URL.revokeObjectURL(url);
        });

        const editBtn = document.createElement('button');
        editBtn.className = 'btn-edit';
        editBtn.textContent = 'Edit';
        editBtn.addEventListener('click', () => editFile(file));

        const downloadBtn = document.createElement('button');
        downloadBtn.className = 'btn-download';
        downloadBtn.textContent = 'Download';
        downloadBtn.addEventListener('click', () => redownloadFile(file));

        const deleteBtn = document.createElement('button');
        deleteBtn.className = 'btn-delete';
        deleteBtn.textContent = 'Delete';
        deleteBtn.addEventListener('click', () => {
          if (confirm(`Delete "${file.filename}"?`)) {
            deleteFile(file.id);
          }
        });

        actions.appendChild(viewBtn);
        actions.appendChild(editBtn);
        actions.appendChild(downloadBtn);
        actions.appendChild(deleteBtn);

        card.appendChild(title);
        card.appendChild(meta);
        card.appendChild(snippet);
        card.appendChild(actions);
        listEl.appendChild(card);
      });
    }

    // Format toggle
    document.querySelectorAll('.toggle-option').forEach(option => {
      option.addEventListener('click', () => {
        setFormat(option.dataset.format);
      });
    });

    // Download button
    document.getElementById('download').addEventListener('click', function() {
      const content = document.getElementById('content').value;
      if (!content) {
        alert('Please enter some content first!');
        return;
      }

      let filename = document.getElementById('filename').value.trim() || 'untitled';
      if (!filename.endsWith('.' + currentFormat)) {
        filename += '.' + currentFormat;
      }

      const blob = new Blob([content], { type: 'text/plain' });
      const url = URL.createObjectURL(blob);
      const link = document.createElement('a');
      link.href = url;
      link.download = filename;
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      URL.revokeObjectURL(url);

      const snippet = content.substring(0, 80).replace(/\n/g, ' ');
      saveFileMeta({ filename, snippet, content, timestamp: Date.now() });
      loadAndRenderFiles();

      // Clear and focus
      document.getElementById('content').value = '';
      document.getElementById('filename').value = '';
      document.getElementById('content').focus();
    });

    // Search
    document.getElementById('searchInput').addEventListener('input', (e) => {
      renderList(e.target.value.toLowerCase());
    });

    // Theme toggle with system preference detection
    function initTheme() {
      const savedTheme = localStorage.getItem('theme');
      const themeToggle = document.getElementById('themeToggle');

      let theme;
      if (savedTheme) {
        theme = savedTheme;
      } else {
        // Detect system preference
        theme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
      }

      if (theme === 'dark') {
        document.body.classList.add('dark-mode');
        themeToggle.textContent = '☀️';
      } else {
        themeToggle.textContent = '🌙';
      }
    }

    document.getElementById('themeToggle').addEventListener('click', function() {
      document.body.classList.toggle('dark-mode');
      const isDark = document.body.classList.contains('dark-mode');
      localStorage.setItem('theme', isDark ? 'dark' : 'light');
      this.textContent = isDark ? '☀️' : '🌙';
    });

    document.getElementById('clearAll').addEventListener('click', clearAllFiles);

    // Keyboard shortcuts
    document.addEventListener('keydown', (e) => {
      // Cmd/Ctrl + S to download
      if ((e.metaKey || e.ctrlKey) && e.key === 's') {
        e.preventDefault();
        document.getElementById('download').click();
      }
      // Cmd/Ctrl + K to focus search
      if ((e.metaKey || e.ctrlKey) && e.key === 'k') {
        e.preventDefault();
        document.getElementById('searchInput').focus();
      }
    });

    // Initialize
    window.addEventListener('DOMContentLoaded', () => {
      initTheme();
      loadAndRenderFiles();
      document.getElementById('content').focus();
    });
  </script>
</body>
</html>
